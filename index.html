<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üåπüëì –ü–æ–∫—É–ø–∫–∏</title>
  <meta name="color-scheme" content="dark" />
  <style>
    :root{
      --bg:#0b0710;
      --bg2:#1a0c22;
      --card:rgba(255,255,255,.07);
      --line:rgba(255,255,255,.14);
      --text:#ffeefb;
      --muted:#e5c4db;
      --accent:#ff4f9a;
      --accent2:#8f6bff;
      --good:#31d0aa;
      --warn:#ff9f44;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 10% 0%, #471336 0%, transparent 55%),
        radial-gradient(900px 500px at 100% 10%, #2a1951 0%, transparent 55%),
        linear-gradient(160deg, var(--bg), var(--bg2));
      min-height:100vh;
    }
    .wrap{max-width:1060px;margin:0 auto;padding:24px 14px 42px;}
    header{display:flex;gap:14px;justify-content:space-between;align-items:end;margin-bottom:16px;}
    h1{margin:0;font-size:clamp(24px,4.5vw,42px);letter-spacing:.2px;}
    .sub{margin-top:6px;color:var(--muted);font-size:14px;}
    .pill{border:1px solid var(--line);background:rgba(255,255,255,.06);border-radius:999px;padding:7px 12px;font-size:13px;white-space:nowrap}
    .grid{display:grid;grid-template-columns:1.25fr .9fr;gap:12px;}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      backdrop-filter: blur(10px);
      box-shadow:0 10px 24px rgba(0,0,0,.22);
      padding:14px;
    }
    .card h2{margin:0 0 10px;font-size:18px}

    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px;align-items:center}
    select, input{
      background:rgba(255,255,255,.06);
      border:1px solid var(--line);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      font-size:14px;
      outline:none;
    }
    input{flex:1;min-width:220px}

    .list{display:grid;gap:10px}
    .item{
      display:grid;
      grid-template-columns:120px 1fr;
      gap:10px;
      border:1px solid var(--line);
      border-radius:16px;
      overflow:hidden;
      background:rgba(255,255,255,.05);
    }
    .img{
      width:120px;height:100%; min-height:116px;
      display:grid;place-items:center;
      background:linear-gradient(135deg, rgba(255,79,154,.22), rgba(143,107,255,.18));
      border-right:1px solid rgba(255,255,255,.10);
      overflow:hidden;
    }
    .img svg{width:30px;height:30px;opacity:.95}
    .img img{width:100%;height:100%;object-fit:cover;display:block}
    .meta{padding:10px 10px 10px 0}
    .price{font-size:12px;color:#fff;border:1px solid rgba(255,255,255,.2);padding:4px 8px;border-radius:999px;background:rgba(255,255,255,.09)}
    .best{color:#ffe2a6;border-color:rgba(255,226,166,.5);background:rgba(255,226,166,.14)}
    .row{display:flex;gap:10px;justify-content:space-between;align-items:center}
    .name{font-weight:750}
    .tags{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
    .tag{font-size:12px;color:#f4d8ea;border:1px solid rgba(255,255,255,.16);padding:3px 8px;border-radius:999px;background:rgba(255,255,255,.05)}
    details{margin-top:8px}
    details summary{cursor:pointer;color:#ffd7ea}
    .desc{margin-top:8px;color:var(--muted);font-size:13.5px;line-height:1.35}
    .links{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .a{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      color:var(--text);text-decoration:none;
      background:rgba(255,255,255,.06);
      font-size:13px;
    }
    .a:hover{border-color:rgba(255,255,255,.28)}
    .kpi{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .k{border:1px solid var(--line);background:rgba(255,255,255,.05);border-radius:14px;padding:10px 12px}
    .k .v{font-weight:800}
    .footer{margin-top:10px;color:#dcb4cb;font-size:12px}
    .ok{color:var(--good);font-weight:700}
    .w{color:var(--warn);font-weight:700}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>üåπüëì –ü–æ–∫—É–ø–∫–∏</h1>
        <div class="sub">–ö—Ä–∞—Å–∏–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ–¥ <b>–ë–∞—Ä—Å–µ–ª–æ–Ω—É</b> –∏ <b>–ö–∏—à–∏–Ω—ë–≤</b>.</div>
      </div>
      <div class="pill" id="updated"></div>
    </header>

    <div class="grid">
      <section class="card">
        <h2>üßæ –ù—É–∂–Ω–æ –∫—É–ø–∏—Ç—å</h2>
        <div class="controls">
          <select id="city">
            <option value="all">–í—Å–µ –≥–æ—Ä–æ–¥–∞</option>
            <option value="barcelona">–ë–∞—Ä—Å–µ–ª–æ–Ω–∞</option>
            <option value="chisinau">–ö–∏—à–∏–Ω—ë–≤</option>
          </select>
          <input id="q" placeholder="–ü–æ–∏—Å–∫: –≤–∞–Ω–Ω–∞ / –∫—É—Ö–Ω—è / –±—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è‚Ä¶" />
        </div>
        <div class="list" id="todo"></div>
        <div class="footer">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –æ–ø–∏—Å–∞–Ω–∏—è ‚Äî —ç—Ç–æ –º–æ–∏ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–Ω–µ —Ä–µ–∫–ª–∞–º–∞). –°—Å—ã–ª–∫–∏ ‚Äî —É–¥–æ–±–Ω—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ/–º–∞–≥–∞–∑–∏–Ω–Ω—ã–µ.</div>
      </section>

      <section class="card">
        <h2>‚úÖ –ö—É–ø–∏–ª–∏</h2>
        <div class="kpi" id="kpi"></div>
        <div class="list" id="done"></div>
      </section>
    </div>
  </div>

  <script>
    // Data is embedded for GitHub Pages simplicity.
    const DATA = {
      updatedAt: new Date().toISOString(),
      people: {
        barcelona: ['@sprodan', '@mprodan'],
        chisinau: ['@Didinap', '@Papuc_Eugen']
      },
      todo: [
        {
          id: 'herbes-de-provence',
          name: '–ü—Ä–æ–≤–∞–Ω—Å–∫–∏–µ —Ç—Ä–∞–≤—ã',
          category: '—Å–ø–µ—Ü–∏–∏',
          addedBy: '@Didinap',
          cities: ['chisinau'],
          icon: 'bath',
          image: 'https://images.unsplash.com/photo-1471194402529-8e0f5a675de6?auto=format&fit=crop&w=600&q=80',
          primary: {
            chisinau: { shop: 'Linella', price: '2.90 MDL', note: '–≠–ö–û –ü—Ä–æ–≤–∞–Ω—Å–∫–∏–µ —Ç—Ä–∞–≤—ã 10–≥', url: 'https://linella.md/ru/catalog/spetsii/eko_provanskie_travyi_10g?from=CATALOGUE' },
            barcelona: { shop: 'Mercadona', price: '‚âà1.30‚Äì1.90 ‚Ç¨', note: 'Hierbas provenzales (–æ—Ä–∏–µ–Ω—Ç–∏—Ä)', url: 'https://www.mercadona.es/busqueda?query=hierbas%20provenzales' }
          },
          alternatives: {
            chisinau: [
              { shop:'METRO (zakaz)', price:'19.90 MDL / 20–≥', note:'ASW Provensale', url:'https://metro.zakaz.md/ro/products/null--04841947000380/' },
              { shop:'MegaAlina', price:'31.99 MDL / 10–≥', note:'Kamis Ierburi de Provence', url:'https://megaalina.md/ro/6695088/' }
            ],
            barcelona: [
              { shop:'Carrefour', price:'‚âà1.50‚Äì2.50 ‚Ç¨', note:'–ø–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É', url:'https://www.carrefour.es/?q=hierbas%20provenzales' },
              { shop:'Amazon.es', price:'–æ—Ç ‚âà2 ‚Ç¨', note:'—Ä–∞–∑–Ω—ã–µ –±—Ä–µ–Ω–¥—ã', url:'https://www.amazon.es/s?k=hierbas+provenzales' }
            ]
          },
          why: {
            barcelona: {
              title: '–Ø –±—ã —Å–º–æ—Ç—Ä–µ–ª –≤ Mercadona/Carrefour, —Å–º–µ—Å—å "Hierbas provenzales" –±–µ–∑ —Å–æ–ª–∏',
              text: '–õ—É—á—à–µ –±—Ä–∞—Ç—å —á–∏—Å—Ç—É—é —Å–º–µ—Å—å —Ç—Ä–∞–≤ –±–µ–∑ —Å–æ–ª–∏ –∏ —É—Å–∏–ª–∏—Ç–µ–ª–µ–π ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ –∫ –º—è—Å—É, –æ–≤–æ—â–∞–º –∏ —Å—É–ø–∞–º.'
            },
            chisinau: {
              title: '–õ—É—á—à–∏–π –±–∞–∑–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –≤ –ö–∏—à–∏–Ω—ë–≤–µ ‚Äî Linella',
              text: '–°–µ–π—á–∞—Å —ç—Ç–æ —Å–∞–º—ã–π –≤—ã–≥–æ–¥–Ω—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ —Ü–µ–Ω–µ –∑–∞ 10–≥, –ø—Ä–∏ —ç—Ç–æ–º —Å–æ—Å—Ç–∞–≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π.'
            }
          },
          links: {
            barcelona: [
              { label:'Mercadona (–ø–æ–∏—Å–∫)', url:'https://www.mercadona.es/busqueda?query=hierbas%20provenzales' },
              { label:'Carrefour (–ø–æ–∏—Å–∫)', url:'https://www.carrefour.es/?q=hierbas%20provenzales' }
            ],
            chisinau: [
              { label:'Linella (—Ç–æ–≤–∞—Ä)', url:'https://linella.md/ru/catalog/spetsii/eko_provanskie_travyi_10g?from=CATALOGUE' },
              { label:'Kaufland (–ø–æ–∏—Å–∫)', url:'https://www.google.com/search?q=Kaufland+Chi%C8%99in%C4%83u+%D0%BF%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D1%81%D0%BA%D0%B8%D0%B5+%D1%82%D1%80%D0%B0%D0%B2%D1%8B' }
            ]
          }
        }
      ],
      done: [
        {
          id: 'bath-cleaner',
          name: '–°—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è –≤–∞–Ω–Ω—ã',
          category: '–±—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è',
          addedBy: '@Didinap',
          cities: ['chisinau'],
          icon: 'bath',
          image: 'https://images.unsplash.com/photo-1584622781564-1d987f7333c1?auto=format&fit=crop&w=600&q=80',
          primary: {
            chisinau: { shop:'–ö—É–ø–ª–µ–Ω–æ', price:'‚Äî', note:'–ü—É–Ω–∫—Ç –∑–∞–∫—Ä—ã—Ç', url:'#' }
          },
          alternatives: { chisinau: [] },
          why: {
            chisinau: {
              title: '–ö—É–ø–ª–µ–Ω–æ –≤ –ö–∏—à–∏–Ω—ë–≤–µ ‚úÖ',
              text: '–û—Ç–ª–∏—á–Ω–æ, –ø—É–Ω–∫—Ç –∑–∞–∫—Ä—ã—Ç.'
            }
          },
          links: {
            chisinau: []
          }
        }
      ]
    };

    const ICONS = {
      bath: `
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 6a3 3 0 0 1 6 0v3" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M4 9h16v6a5 5 0 0 1-5 5H9a5 5 0 0 1-5-5V9Z" stroke="white" stroke-width="1.6"/>
          <path d="M6 20v2M18 20v2" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M3 12h18" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
        </svg>`
    };

    const cityName = (c) => c === 'barcelona' ? '–ë–∞—Ä—Å–µ–ª–æ–Ω–∞' : c === 'chisinau' ? '–ö–∏—à–∏–Ω—ë–≤' : c;

    const elTodo = document.getElementById('todo');
    const elDone = document.getElementById('done');
    const elUpdated = document.getElementById('updated');
    const elKpi = document.getElementById('kpi');

    elUpdated.textContent = `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${new Date().toLocaleString('ru-RU')}`;

    const render = () => {
      const city = document.getElementById('city').value;
      const q = document.getElementById('q').value.trim().toLowerCase();

      const filterItem = (it) => {
        const cityOk = city === 'all' || it.cities.includes(city);
        const qOk = !q || (it.name + ' ' + (it.category||'')).toLowerCase().includes(q);
        return cityOk && qOk;
      };

      const card = (it) => {
        // If user didn't choose a city, default to the item's city (or addedBy home city) for recommendations.
        const homeCity = (it.addedBy && Object.entries(DATA.people).find(([,arr]) => arr.includes(it.addedBy))?.[0]) || null;
        const c = (city === 'all') ? (it.cities[0] || homeCity || 'barcelona') : city;
        const why = it.why?.[c];
        const links = it.links?.[c] || [];
        const primary = it.primary?.[c] || null;
        const alternatives = it.alternatives?.[c] || [];

        const cityTags = it.cities.map(x => `<span class="tag">${cityName(x)}</span>`).join('');
        const catTag = it.category ? `<span class="tag">${it.category}</span>` : '';
        const byTag = it.addedBy ? `<span class="tag">–¥–æ–±–∞–≤–∏–ª(–∞) ${it.addedBy}</span>` : '';

        return `
          <div class="item">
            <div class="img">${it.image ? `<img src="${it.image}" alt="${it.name}" loading="lazy"/>` : (ICONS[it.icon] || '')}</div>
            <div class="meta">
              <div class="row">
                <div class="name">${it.name}</div>
                <div class="tag">#${it.id}</div>
              </div>
              <div class="tags">${cityTags}${catTag}${byTag}</div>

              ${primary ? `<div class="tags" style="margin-top:8px"><span class="price best">‚≠ê ${primary.shop}: ${primary.price}</span><span class="tag">${primary.note || ''}</span></div>` : ''}
              ${primary?.url && primary.url !== '#' ? `<div class="links"><a class="a" href="${primary.url}" target="_blank" rel="noopener noreferrer">üõí –ö—É–ø–∏—Ç—å: ${primary.shop}</a></div>` : ''}

              <details>
                <summary>${why?.title || '–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏ –æ–ø–∏—Å–∞–Ω–∏–µ'}</summary>
                <div class="desc">${why?.text || '–î–æ–±–∞–≤—å –≥–æ—Ä–æ–¥ –≤ —Ñ–∏–ª—å—Ç—Ä–µ ‚Äî –ø–æ–∫–∞–∂—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ–µ.'}</div>
                ${alternatives.length ? `<div class="desc" style="margin-top:8px"><b>–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:</b></div>
                <div class="links">${alternatives.map(a => `<a class="a" href="${a.url}" target="_blank" rel="noopener noreferrer">üîÅ ${a.shop}: ${a.price}</a>`).join('')}</div>` : ''}
                <div class="links">
                  ${links.map(l => `<a class="a" href="${l.url}" target="_blank" rel="noopener noreferrer">üîó ${l.label}</a>`).join('')}
                </div>
              </details>
            </div>
          </div>
        `;
      };

      const todo = DATA.todo.filter(filterItem);
      elTodo.innerHTML = todo.length ? todo.map(card).join('') : `<div style="color:var(--muted)">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –î–æ–±–∞–≤—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä –≤ —á–∞—Ç ‚Äî –∏ —è –æ–±–Ω–æ–≤–ª—é —Å–∞–π—Ç.</div>`;

      const done = DATA.done.filter(filterItem);
      elDone.innerHTML = done.length ? done.map(card).join('') : `<div style="color:var(--muted)">–ü–æ–∫–∞ –ø—É—Å—Ç–æ.</div>`;

      const total = DATA.todo.length + DATA.done.length;
      elKpi.innerHTML = `
        <div class="k"><div class="v">${DATA.todo.length}</div><div class="t" style="color:var(--muted);font-size:12px">–Ω—É–∂–Ω–æ –∫—É–ø–∏—Ç—å</div></div>
        <div class="k"><div class="v">${DATA.done.length}</div><div class="t" style="color:var(--muted);font-size:12px">–∫—É–ø–∏–ª–∏</div></div>
        <div class="k"><div class="v">${total}</div><div class="t" style="color:var(--muted);font-size:12px">–≤—Å–µ–≥–æ</div></div>
      `;
    };

    document.getElementById('city').addEventListener('change', render);
    document.getElementById('q').addEventListener('input', render);

    render();
  </script>
</body>
</html>
